{% from "components/site.html" import
padding,
ModuleHeading,
ModuleSectionHeading,
Capsule,
genericDemo,
paddingDemo,
marginDemo,
DisplayValue,
BoxSelectionResultDemo %}

{% set durations = tw.global.transitionDuration %}
{% set durationsListLength = durations | length %}
{% set easings = tw.global.transitionTimingFunction %}

{{ ModuleHeading('transitions') }}

<article class="{{ padding() }}" x-data="Transitions()" x-init="init()">
  {{ ModuleSectionHeading('Transition duration', 'https://tailwindcss.com/docs/margin') }}

  {# <div class="flex flex-wrap justify-between px-2 mt-8">
    <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 33 33">
      <circle cx="14.1345" cy="15.2847" r="11.5" fill="#F59E0B"/>
      <path fill="#F9FAFB" d="M7.6345 10.2847c.6468-1.5379 1.5-4 1.5-4 3.2 2.4 2.6667 7.3333 2 9.5l-1.5 4 7-4.5 2-1.5-1.5-1 1-2.5c-.5151-1.2965-1.1867-2.5494-1-4l4.5.5h3.5l4.5-.5c.3185.9663-.162 3.0766-.5 3.5-.2496.3126.3334 2.1666.5 3 0 0-3.3561 1.5113-4.1252 3.306-1.5 3.5-1.8748 10.194-1.8748 10.194s.2515.641.5 1c.3144.4541 1 1 1 1h-5.5l-.5-2.5-2.5 1.5.5 1h-4l-3.5-1.5s-3.1312-.6492-4.5-2c-1.758-1.7349-2-2.5-2-6 0-3.756 3.0438-5.0379 4.5-8.5Z"/>
      <path fill="#6B7280" d="M2.8161 17.6709c.3877-1.9191 1.5237-3.4164 2.7266-5.0016 1.3935-1.8366 2.8345-3.7356 3.2291-6.479a.3372.3372 0 0 1 .5268-.2285c1.8016 1.2578 2.7963 3.1693 2.8763 5.5276.0648 1.9051-.4645 4.046-1.4901 6.0281-.2381.4602-.4098.9246-.5178 1.4018.9591-.9812 2.3171-1.8447 4.074-2.5847l.211-.0913c.701-.3399 2.0279-1.1942 3.5941-2.3118a82.7211 82.7211 0 0 0-1.1189-.7482.3372.3372 0 0 1-.1487-.3308 9.1152 9.1152 0 0 1 .0524-.3144c.0028-.015.0054-.0298.0083-.0446.1492-.7917.4028-1.5352.7571-2.221-.572-1.1809-1.3214-3.549-.6486-4.222.7065-.7063 3.3108.1455 4.5222.8038a6.0704 6.0704 0 0 1 1.9275-.315c.6917 0 1.3602.118 1.9906.3362 1.1938-.661 3.8468-1.5388 4.5609-.8249.6913.6914-.1235 3.1845-.6974 4.3205.327.6574.5627 1.3686.7048 2.1248a8.7164 8.7164 0 0 1 .0599.3551l.0003.0017a.3373.3373 0 0 1-.1487.3308 79.1236 79.1236 0 0 0-.2996.1977c-.0076.0051-.0152.01-.0228.0152a66.2135 66.2135 0 0 0-.276.1841l-.0615.0413a77.844 77.844 0 0 0-.2803.1888l-.0286.0194a108.6015 108.6015 0 0 0-2.8365 1.9916l-.021.0862c-.1947.7979-.4636 1.8988-.9374 3.1178l-1.1893 7.5158c.9515.3048 1.6133 1.0679 1.6133 1.9059a.3372.3372 0 0 1-.3371.3372h-5.8263a.3373.3373 0 0 1-.3311-.273l-.3894-2.0087a8.9268 8.9268 0 0 1-1.3762.745c.3046.288.5187.671.5176 1.2003a.3372.3372 0 0 1-.3372.3365h-4.4173l-.0011.0001a.3377.3377 0 0 1-.0638-.0065c-.0087-.0017-.0168-.0047-.0253-.007-.0099-.0028-.0199-.0046-.0297-.0082l-.0118-.0047c-.7243-.2745-1.3787-.6602-1.9465-1.106-3.2516-.5394-5.6066-1.8305-6.9992-3.8392-1.1878-1.7128-1.5917-3.8941-1.1376-6.1422Zm16.1234-3.945.0953.0657.0632.0438.0897.062.0668.0463.0922.0641.0692.0482.0919.0641.0754.0527.0899.063.0796.056.0904.0635.083.0585a82.6588 82.6588 0 0 1 .1779.1259l.0875.062.0948.0674.0834.0594.0985.0703.0872.0624.0991.0712.0861.0618.1035.0746.0862.0623.1061.0768.085.0616.1113.081.0839.0612.1115.0815.0881.0647c.0371.0272.0743.0544.1116.0819l.0883.065.1147.0847.0868.0643.117.0868.0899.067.1155.0861.0916.0685.0874.0655-.0001-.0038c0-.144.0319-.2804.0878-.4035-.0616-1.6921-.5136-4.3763-1.9108-5.4011-.5932-.435-1.293-.5318-2.1358-.2947-.3712.6017-.6614 1.2769-.8498 2.0084-.0057.0225-.0109.0451-.0165.0676a7.6995 7.6995 0 0 0-.0534.2278 7.9302 7.9302 0 0 0-.0477.2434c-.0042.0227-.0092.0449-.0131.0676a86.2547 86.2547 0 0 1 .7435.4972l.1147.0777c.0068.0046.0139.0093.0206.014l.1082.0735.0355.0242.1013.0691.0351.0239.1054.0721.0422.029.1011.0694c.0171.0121.0348.0243.0523.0364Zm3.1472 9.0901c1.13-1.3021 1.8669-2.71 2.3698-3.9916a.3384.3384 0 0 1 .0293-.0742c.3288-.8499.5554-1.6412.7267-2.3055a92.916 92.916 0 0 0-.6309.4723c-.0053.0039-.0108.0072-.016.0111l-.0291.0218a1.0768 1.0768 0 0 1-.0837.0563c-.0068.0044-.0138.0085-.0208.0128l-.0205.0128-.0379.0231-.0339.0178a2.1559 2.1559 0 0 1-.0887.0459l-.0321.0164c-.0044.0023-.0092.0031-.0136.0051a1.9427 1.9427 0 0 1-.8079.1778c-.304 0-.6077-.0725-.8878-.2159l-.0011-.0004-.0013-.0008a1.981 1.981 0 0 1-.1199-.0677c-.0067-.0039-.013-.007-.0197-.0111l-.0095-.0057-.0011-.0008a2.0508 2.0508 0 0 1-.1438-.0988 32.4165 32.4165 0 0 1-.0611-.046l-.0654 5.9453Zm6.3155-9.4643.0034-.0023a130.293 130.293 0 0 1 .3357-.227c.0888-.0597.1728-.1159.2519-.1688l.0377-.0251c.1041-.0695.1992-.1326.2845-.189-.0048-.0276-.0108-.0544-.0158-.0818a7.506 7.506 0 0 0-.0442-.2258 7.6396 7.6396 0 0 0-.0636-.2711l-.004-.0164c-.1884-.7362-.4801-1.4155-.8535-2.0206-.8493-.238-1.5587-.1374-2.1644.307-1.3951 1.0233-1.8723 3.5748-1.9554 5.2549a.9732.9732 0 0 1 .1617.5382l-.0002.0031c.188-.141.3788-.283.5721-.4257a106.4792 106.4792 0 0 1 3.4541-2.4496Zm-9.5286-6.7548c-.9311-.2156-1.3785-.14-1.4492-.0696-.1961.197-.0253 1.6093.5899 3.0413.6803-1.0285 1.5856-1.8457 2.6303-2.371-.5494-.2474-1.1851-.465-1.771-.6007Zm.1518 2.7412c.7357-.0615 1.3957.117 1.969.5375 1.3952 1.0234 2.0144 3.3724 2.1593 5.4014a.9795.9795 0 0 1 .2437-.0317.98.98 0 0 1 .1724.0161c.1193-1.4736.563-4.1726 2.2014-5.3742.5842-.4285 1.2538-.611 1.998-.5492-1.1043-1.3196-2.6613-2.1243-4.3718-2.1243-1.7107-.0001-3.2677.8047-4.372 2.1244Zm10.4465-2.8108c-.0707-.0704-.5181-.146-1.4492.0696-.605.1401-1.2633.3674-1.8246.625 1.036.532 1.9322 1.3525 2.6047 2.3814a.3382.3382 0 0 1 .042.0508c.6449-1.4604.8265-2.9264.6271-3.1268Zm-6.0045 20.5935a.3373.3373 0 0 1-.2667-.3833l.8813-5.5687c-.5191.8987-1.1735 1.8038-2.0063 2.6538l-.0297 2.7059c.8426.2561 1.4649.8699 1.6172 1.5815h1.1302c-.1684-.4672-.6748-.8586-1.326-.9892Zm-7.8205-.0002a15.7256 15.7256 0 0 1-.2569-.1012.3372.3372 0 0 1-.073-.5835l.4784-.3531a2.3368 2.3368 0 0 0 .9454-1.8729c0-1.2834-1.0442-2.3276-2.3276-2.3276h-1.0133a.3372.3372 0 0 1 0-.6743h1.0133c1.6553 0 3.0019 1.3467 3.0019 3.0019 0 .9445-.4514 1.8434-1.2084 2.4073.1251.0518.2544.109.3827.1733.408-.1452 1.1261-.4504 1.9147-1.0091l-1.0036-5.1763a.337.337 0 1 1 .662-.1283l1.48 7.6331h3.323c-.1683-.4672-.6747-.8585-1.3259-.9892a.337.337 0 0 1-.2708-.3343l.1144-10.4153a105.776 105.776 0 0 0-2.8452-2.0342c-.9113.6544-2.8296 1.9997-3.8989 2.5164a.2381.2381 0 0 1-.0127.0058l-.2206.0955c-2.141.9018-3.6342 1.9578-4.4964 3.1853a.3348.3348 0 0 1-.099.1433c-.7417 1.1319-.9575 2.4073-.657 3.8401.1928.9182.9589 2.0715 2.0776 2.9637l.0034.0028c.5182.4127 1.1119.7691 1.7595 1.0202h3.9628c-.1667-.4705-.7032-.7154-1.4098-.9894ZM4.5075 23.4287c1.1327 1.6338 2.9811 2.7575 5.5033 3.349-.7599-.8332-1.2564-1.7489-1.4173-2.5159-.3391-1.6166-.0805-3.0693.7666-4.351.038-.9474.2755-1.8328.7257-2.7032 1.6593-3.2068 2.4002-7.7566-.7417-10.3644-.5185 2.615-1.9129 4.4526-3.2643 6.2336-1.1548 1.522-2.2457 2.9597-2.6028 4.7276-.4174 2.0665-.0514 4.0639 1.0305 5.6243Z"/>
      <path fill="#6B7280" d="M25.5957 13.3882a.3372.3372 0 1 1 0-.6745.3372.3372 0 0 1 0 .6745Zm-4.4885 0a.3372.3372 0 1 1 0-.6745.3372.3372 0 0 1 0 .6745Z"/>
    </svg>

    <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 33 33">
      <circle cx="19.1012" cy="16.307" r="9.4928" fill="#34D399"/>
      <path fill="#F9FAFB" fill-rule="evenodd" d="M18.2489 13.1947a9.0155 9.0155 0 0 0-3.8922 1.473c-2.2038 1.4888-3.718 3.921-3.9633 6.7171h-.332c-.3208-1.2253-1.4329-2.1045-2.729-2.1045-1.366 0-2.5358.9787-2.7769 2.3233l-.1344.7498v.0001a.9672.9672 0 0 0-.0142.2175c.0241.4979.436.9121.9594.9121h4.5874l.016.0001h.3898v3.1971l-.7501 1.2926h5.24v-2.8766c2.9053.5784 6.2552.5872 9.1566.0144v1.5696l-.7501 1.2926h5.2399v-4.4897h.237c.552 0 1.0043-.4261 1.0461-.9673a1.046 1.046 0 0 0-.3011-.8208 1.0467 1.0467 0 0 0-.7449-.3103h-.272c-.2916-3.3244-2.3769-6.1342-5.2823-7.456a9.009 9.009 0 0 0-2.8243-.7631 9.186 9.186 0 0 0-.9269-.0468m-1.1785.0758a9.1609 9.1609 0 0 1 1.1782-.0758h.0001" clip-rule="evenodd"/>
      <path fill="#6B7280" d="M28.584 21.0731c-.2628-2.2181-1.3074-4.2644-2.9621-5.7881-1.7356-1.598-3.9916-2.4781-6.3524-2.4781-4.6829 0-8.5753 3.4494-9.2701 7.9408-.5103-1.0595-1.5961-1.7795-2.8246-1.7795a3.1302 3.1302 0 0 0-3.084 2.5802l-.1344.7498a1.269 1.269 0 0 0 .2764 1.0408c.2423.2897.598.4558.9757.4558H9.89v2.8014l-.708 1.22a.3119.3119 0 0 0 .2697.4685h5.24a.312.312 0 0 0 .3119-.3119V25.471c1.3838.2499 2.85.3764 4.3144.3764 1.4366 0 2.8694-.1218 4.2184-.3627v1.1115l-.708 1.22a.312.312 0 0 0 .2697.4685h5.24a.312.312 0 0 0 .3119-.3119v-4.1817c.7156-.0392 1.2863-.6321 1.2863-1.3573.0001-.7475-.6058-1.3559-1.3523-1.3607Zm-23.3755 2.098a.6468.6468 0 0 1-.4972-.2323.6466.6466 0 0 1-.1409-.5304l.1345-.7498a2.507 2.507 0 0 1 2.4699-2.0665c1.2556 0 2.3252.9388 2.4881 2.1838l.1826 1.3952h-4.637Zm14.061-9.7404c2.1354 0 4.1787.7713 5.7773 2.1761-1.164 1.7682-3.3481 2.8558-5.7767 2.8558-2.4272 0-4.6101-1.0863-5.7746-2.8526 1.5425-1.3557 3.5637-2.1793 5.774-2.1793Zm-6.0073 2.3917c1.2284 1.8292 3.4946 2.9522 6.0079 2.9522 2.5144 0 4.7816-1.1241 6.0097-2.9549 1.4798 1.397 2.4208 3.2475 2.6757 5.2529H10.5834c.2625-2.0572 1.242-3.8934 2.6788-5.2502ZM9.9935 27.6609l.4782-.8241a.3118.3118 0 0 0 .0422-.1565V23.795h3.866v3.866H9.9935v-.0001Zm5.0102-2.8241v-1.0419h8.5327v1.0558c-2.7173.5006-5.7975.4953-8.5327-.0139Zm13.0225 2.8241h-4.3864l.4783-.8241a.3118.3118 0 0 0 .0422-.1565V23.795h3.866v3.8659h-.0001Zm.549-4.4898H10.5127v-.9836c0-.1648.005-.3284.0141-.491h18.0484c.4065 0 .7373.3308.7373.7373s-.3308.7373-.7373.7373Z"/>
      <path fill="#6B7280" d="M5.7594 21.5997a.312.312 0 1 0 0-.6239.312.312 0 0 0 0 .6239Z"/>
    </svg>
    <span class="block w-full h-1 rounded-full bg-gradient-to-r from-red-400 via-yellow-400 to-green-400"></span>
  </div> #}

  <div
    data-io-root
    class="relative overflow-hidden">
    <div data-io-shadow="start" class="absolute top-0 z-20 w-2 h-full -left-2"></div>
    <div class="h-20 max-w-full overflow-x-auto">
      <fieldset class="flex items-center h-full text-sm">
        {% for key, value in durations %}
          {% if key !== 'DEFAULT' %}
            <button
            @click="setDuration( {{ key|safe }} )"
             {% if loop.first %}data-io-target="start"{% endif %}
             {% if loop.last - 1 %}data-io-target="end"{% endif %}
            class="{{ isDefaultValue }} z-10 w-32 px-4 py-2 m-2 font-bold tracking-wider text-center uppercase transition-all duration-100 bg-white border-2 border-transparent rounded cursor-pointer ease hover:border-green-400"
            :class="{ 'bg-green-600 border-green-500 text-white shadow-inset': currentDuration === {{ key|safe }}, 'text-gray-400 active shadow-lg': currentDuration !== {{ key|safe }} }"
          >{{- key -}}
              <span class="font-normal lowercase">ms</span>
            </button>
          {% endif %}
        {% endfor %}
      </fieldset>
    </div>
    <div data-io-shadow="end" class="absolute top-0 z-20 block w-2 h-full -right-2"></div>
  </div>

  {% for key, value in easings %}
    <div x-data="{ isPlaying: false }" class="mt-8">
      <div @click="isPlaying = !isPlaying"
      class="relative flex items-center flex-grow w-full h-20 bg-gray-100 border border-gray-200 rounded hover:cursor-pointer lg:order-last">

        <span class="absolute inset-x-0 block w-full h-20 text-xs text-center text-gray-400 inset-y-4">{{ value }}</span>

        <div
        :style="{ animationDuration: `${currentDuration}ms`,  animationTimingFunction: `{{ key }}`, animationIterationCount: `${currentIterationCount}` }"
        :class="{ 'animate-active' : isPlaying }"
        class="absolute animate-horz transform top-1/2 -translate-y-1/2 w-10 h-16 rounded transition-all bg-green-400 ease-{{ key }}"></div>
      </div>
      <div class="flex items-start justify-between mt-3">
        {# <div class="w-1/3">{{ Capsule( ['ease-', key] | join('') ) }}</div> #}

        <button
        @click="playAnimation()"
        type="button">Play</button>
        <button
        @click="loopAnimation()"
        type="button">Loop</button>

        {# <span class="w-1/3 text-right">{{ value }}</span> #}
      </div>
    </div>
  {% endfor %}
</article>

<script>
  function Transitions() {
    return {
      isPlaying: false,
      defaultDuration: 150,
      currentDuration: 150,
      currentIterationCount: 1,
      init() {
        this.setDuration(150)
        this.setIterationCount(1)
      },
      startAnimation() {
        this.isPlaying = true
      },
      stopAnimation() {
        this.isPlaying = false
      },
      toggleAnimation() {
        this.isPlaying = !this.isPlaying
      },
      playAnimation() {
        this.setIterationCount(1)
        this.startAnimation()
        setTimeout(() => {
          this.stopAnimation()
        }, this.currentDuration)
      },
      loopAnimation() {
        this.setIterationCount('infinite')
        this.toggleAnimation()
      },
      setDuration(duration) {
        this.currentDuration = duration
      },
      setIterationCount(count) {
        this.currentIterationCount = count

      }
    }
  }
  const ioOptions = {
    root: document.querySelector('[data-io-root]'),
    rootMargin: '',
    threshold: [0, 0.25, 0.5, 0.75, 1]
  }

  const shadowStart = document.querySelector('[data-io-shadow="start"]')
  const shadowEnd = document.querySelector('[data-io-shadow="end"]')
  const toggleShadows = (entries, observer) => {
    entries.forEach((entry) => {
      if (entry.intersectionRatio < 0 || entry.intersectionRatio > 0.5) {
       console.warn(entry.target.dataset.ioTarget)
        document
          .querySelector(`[data-io-shadow="${entry.target.dataset.ioTarget}"]`)
          .classList
          .remove('io-shadow')
      } else {
      console.warn(entry.target.dataset.ioTarget)
        document
          .querySelector(`[data-io-shadow="${entry.target.dataset.ioTarget}"]`)
          .classList
          .add('io-shadow')
      }
    })
  }

  const observer = new IntersectionObserver(toggleShadows, ioOptions)
  const targetEls = [...document.querySelectorAll('[data-io-target]')]
  targetEls.forEach((el) => {
    observer.observe(el)
  })
</script>